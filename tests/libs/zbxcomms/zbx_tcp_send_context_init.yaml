---
test case: "simple TCP, no protocol"
in:
  data: "abc"
  len: 3
  reserved: 0
  flags: 0
out:
  result: "SUCCEED"
---
test case: "with protocol"
in:
  data: "abc"
  len: 3
  reserved: 3
  flags: 1   # ZBX_TCP_PROTOCOL
out:
  result: "SUCCEED"
---
test case: "force compression"
in:
  data: "aaaaaaaaaa"
  len: 10
  reserved: 0
  flags: 3   # ZBX_TCP_PROTOCOL | ZBX_TCP_COMPRESS
  compress_result: "SUCCEED"
out:
  result: "SUCCEED"
---
test case: "force compression - failed compression"
in:
  data: "aaaaaaaaaa"
  len: 10
  reserved: 0
  flags: 3   # ZBX_TCP_PROTOCOL | ZBX_TCP_COMPRESS
  compress_result: "FAIL"
out:
  result: "FAIL"
---
test case: "len > MAX"
in:
  data: "A"
  len: 17179869185
  reserved: 0
  flags: 1
out:
  result: "FAIL"
---
test case: "reserved > MAX"
in:
  data: "A"
  len: 1
  reserved: 17179869185
  flags: 1
out:
  result: "FAIL"
---
test case: "large message, with LARGE flag"
in:
  data: "AAAA"
  len: 5000000000
  reserved: 5000000000
  flags: 5   # ZBX_TCP_PROTOCOL | ZBX_TCP_LARGE
out:
  result: SUCCEED
...